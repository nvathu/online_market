<p-steps [model]="steps" [(activeIndex)]="activeIndex" styleClass="steps-custom"></p-steps>
<div *ngIf="activeIndex === 0" class="step-content">
  <form [formGroup]="addressForm" (ngSubmit)="onAddressSubmit()">
    <div class="form-container">
      <h2>Delivery Address</h2>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="firstName" type="text" id="firstName" required>
          <label for="firstName">* First Name</label>
          <div *ngIf="addressForm.controls['firstName'].invalid && (addressForm.controls['firstName'].dirty || addressForm.controls['firstName'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['firstName'].errors?.['required']">
              First Name is required
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="lastName" type="text" id="lastName" required>
          <label for="lastName">* Last Name</label>
          <div *ngIf="addressForm.controls['lastName'].invalid && (addressForm.controls['lastName'].dirty || addressForm.controls['lastName'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['lastName'].errors?.['required']">
              Last Name is required
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="street" type="text" id="street" required>
          <label for="street">* Street</label>
          <div *ngIf="addressForm.controls['street'].invalid && (addressForm.controls['street'].dirty || addressForm.controls['street'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['street'].errors?.['required']">
              Street is required
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="streetNumber" type="text" id="streetNumber" required>
          <label for="streetNumber">* No.</label>
          <div *ngIf="addressForm.controls['streetNumber'].invalid && (addressForm.controls['streetNumber'].dirty || addressForm.controls['streetNumber'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['streetNumber'].errors?.['required']">
              Is required.
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="postalCode" type="text" id="postalCode" required>
          <label for="postalCode">* Postal Code</label>
          <div *ngIf="addressForm.controls['postalCode'].invalid && (addressForm.controls['postalCode'].dirty || addressForm.controls['postalCode'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['postalCode'].errors?.['required']">
              Is required.
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <input pInputText formControlName="city" type="text" id="city" required>
          <label for="city">* City</label>
          <div *ngIf="addressForm.controls['city'].invalid && (addressForm.controls['city'].dirty || addressForm.controls['city'].touched)" class="error-message">
            <small *ngIf="addressForm.controls['city'].errors?.['required']">
              City is required
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="input-container">
        <p-floatLabel>
          <p-dropdown formControlName="country" placeholder="* Country" [options]="countries" optionLabel="name"></p-dropdown>
          <div class="error-message" *ngIf="addressForm.controls['country'].invalid && (addressForm.controls['country'].dirty || addressForm.controls['country'].touched)">
            <small *ngIf="addressForm.controls['country'].errors?.['required']">
              Country is required
            </small>
          </div>
        </p-floatLabel>
      </div>
      <div class="button-container">
        <button pButton type="submit" label="Next" [disabled]="addressForm.invalid"></button>
      </div>
    </div>
  </form>
</div>
<div *ngIf="activeIndex === 1" class="step-content">
  <div class="form-container">
    <h2>Delivery & Payment</h2>
    <div class="input-container">
      <h3>Shipping Options</h3>
      <div class="shipping-option">
        <p-radioButton name="shipping" value="standard" label="Standard Shipping - 5€ - 3-5 days" [(ngModel)]="selectedShipping"></p-radioButton>
      </div>
      <div class="shipping-option">
        <p-radioButton name="shipping" value="express" label="Express Shipping - 10€ - 1-2 days" [(ngModel)]="selectedShipping"></p-radioButton>
      </div>
      <div class="shipping-option">
        <p-radioButton name="shipping" value="overnight" label="Overnight Shipping - 20€ - Next day" [(ngModel)]="selectedShipping"></p-radioButton>
      </div>
    </div>
    <div class="input-container">
      <h3>Payment Methods</h3>
      <p-radioButton name="payment" value="credit" label="Credit Card" [(ngModel)]="selectedPayment"></p-radioButton>
      <p-radioButton name="payment" value="paypal" label="PayPal" [(ngModel)]="selectedPayment"></p-radioButton>
      <p-radioButton name="payment" value="bank" label="Bank Transfer" [(ngModel)]="selectedPayment"></p-radioButton>
    </div>
    <div class="button-container">
      <button pButton label="Back" icon="pi pi-arrow-left" (click)="prevStep()"></button>
      <button pButton label="Next" [disabled]="!selectedShipping || !selectedPayment" (click)="nextStep()"></button>
    </div>
  </div>
</div>
<div *ngIf="activeIndex === 2" class="step-content">
  <div class="form-container">
    <h2>Summary</h2>
    <div class="summary-item" *ngFor="let item of cartItems">
      <p><strong>{{ getProductName(item.id) }}</strong> - {{ item.quantity }} x {{ getProductPrice(item.id) }}€</p>
    </div>
    <p><strong>Address:</strong> {{ addressForm.value.firstName }} {{ addressForm.value.lastName }}, {{ addressForm.value.street }} {{ addressForm.value.streetNumber }}, {{ addressForm.value.postalCode }} {{ addressForm.value.city }}, {{ addressForm.value.country.name }}</p>
    <p><strong>Shipping:</strong> {{ selectedShipping }}</p>
    <p><strong>Payment:</strong> {{ selectedPayment }}</p>
    <p><strong>Total Price:</strong> {{ totalPrice }}€</p>
    <div class="button-container">
      <button pButton label="Back" icon="pi pi-arrow-left" (click)="prevStep()"></button>
      <button pButton label="Confirm Purchase" icon="pi pi-check" (click)="confirmPurchase()"></button>
    </div>
  </div>
</div>
